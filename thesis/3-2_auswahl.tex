\subsection{Anforderungsanalyse}
An die auszuwählenden Frameworks oder Tools beziehungsweise eine Kombination Mehrerer stellen sich folgende Anforderungen:
\begin{enumerate}
	\item Es muss die Durchführung von Komponententests möglich sein.
	\item Es muss die Durchführung von End-To-End-Tests möglich sein.
	\item Es muss der Test von AngularJS-Anwendungen möglich sein.
	\item Es soll die Testausführung von Komponententests im Browser aus der Konsole heraus möglich sein.
	\item Die Software muss unter Windows 7 funktionieren.
	\item Es darf keine zusätzliche Software (beispielsweise Python) zur Ausführung erforderlich sein; lediglich Node.js ist zulässig, da dies über die Standardsoftwareverteilung der Commerzbank verfügbar ist\todo{quelle}.
	\item Wenn die Software Node.js benötigt, muss sie mit Version 6.9.2 lauffähig sein.
	\item Die Software muss über npm installierbar sein.
	\item Sie muss Open-Source und für den kommerziellen Einsatz freigegeben sein.
	\item Sie soll aktiv gewartet und Fehler in ihr behoben werden.
	%\item Es muss mindestens der aktuelle Commerzbank-Standard, ECMA-262 5.1, unterstützt werden\cite[][10]{coba-programmierrichtlinienJavaScript}.
	\item Gemäß SEF müssen Testfälle eindeutig beschrieben werden; diese Beschreibung auch kann durch Implementierung der Tests erfolgen\cite{coba-sef}. Das Testframework soll daher eine Beschreibung der Tests forcieren.
	\item Der Testcode soll leicht lesbar sein\cite[][7]{coba-programmierrichtlinienAllgemein}; hierzu bietet sich der BDD-Stil an, den das Testframework somit unterstützen soll.
	\item Die Software soll eine geringe Einarbeitungszeit erfordern und problemlos zu verwenden sein. 
	\item Sie soll dem Entwickler eine Flexibilität bei der Formulierung der Testfallimplementationen und Assertions bieten, damit dieser möglichst nah an seinen persönlichen Präferenzen arbeiten kann.
	\item Gemäß SEF sollen Komponententests \glqq einen möglichst großen Teil der Funktionalität abdecken\grqq{}\cite{coba-sef}. Zur Überprüfung dessen muss eine Möglichkeit zur Ermittlung der Code Coverage bestehen.
	\item Die Ausgabe der Testergebnisse muss konfigurierbar sein, um sie gegebenenfalls in Prozessen oder anderen Tools der Commerzbank weiterverwenden zu können.
	\item Bei der Durchführung von End-To-End-Tests soll es möglich sein, die Ergebnisse mit Screenshots zu dokumentieren.
	\item Der Einsatz von Spies, Stubs und Mocks muss bei Unit-Tests möglich sein.
	\item Das Bearbeiten aller Dateien in der TFS-Quellcodeverwaltung soll möglich sein, es dürfen somit keine proprietären Binärdateien zum Einsatz kommen.
\end{enumerate}

\newpage
\input{3_software}

\newpage
\subsection{Auswahlentscheidung}
\label{sec:auswahlentscheidung}
Für die Entscheidungsfindung wird eine Entscheidungsmatrix (s. Tabelle \ref{tbl:entscheidungsmatrix}) erstellt, in welcher die Anforderungen gegen die gefundene Software abgeglichen werden. Ein grüner Haken steht für ein Erfüllen der Anforderung; ein rotes Kreuz für einen Widerspruch. Eine leere Zelle bedeutet, dass die Anforderung bei dieser Software nicht relevant ist, da sie weder positiv noch negativ beeinträchtigt wird. Eine Anforderung wird von der ausgewählten Softwaremenge erfüllt, wenn keine Einzelsoftware der Anforderung widerspricht.

Zur Erfüllung von Anforderung 1 werden ein Testrunner, ein Framework zum Anlegen und Beschreiben der Testfälle sowie eine Assertion-Bibliothek benötigt; zur Erfüllung von Anforderung 2 zusätzlich ein Tool zur Browsersteuerung. Hierzu werden die gefundenen Softwares \todo{?} kategorisiert. Die endgültig ausgewählte Softwaremenge muss mindestens ein Exemplar jeder Kategorie enthalten, damit die Anforderungen 1 und 2 erfüllt werden.

%\begin{table}[H] \centering
	%\begin{tabular}{@{} cl*{11}c @{}}
	%	& & \rot{Karma} & \rot{Mocha} & \rot{AVA} & \rot{QUnit} & \rot{Intern} & \rot{Jasmine} & \rot{Chai} & \rot{Protractor} & \rot{PhantomJS} & \rot{CasperJS} & \rot{Sinon} & \rot{ngMock} \\\hline
	%	& \textit{1a} - Komponententest & \OK & \OK & \OK & \OK & \OK & \OK & & & & & &  \\
	%	
	%\end{tabular}
	\begin{tabularx}{\textwidth}{@{}r@{\hskip 6pt}X|ccccccccccccc}
		&& \multicolumn{12}{c}{Software} \\ &&  \rot{\footnotesize{Karma}} & \rot{\footnotesize{Mocha}} & \rot{\footnotesize{AVA}} & \rot{\footnotesize{QUnit}} & \rot{\footnotesize{Intern}} & \rot{\footnotesize{Jasmine}} & \rot{\footnotesize{Chai}} & \rot{\footnotesize{Protractor}} & \rot{\footnotesize{PhantomJS}} & \rot{\footnotesize{CasperJS}} & \rot{\footnotesize{Sinon}} & \rot{\footnotesize{ngMock}} & \rot{\footnotesize{Istanbul}} \\ \hline
		%									Ka		Mo		Av		QU		In		Ja		Ch		Pr		Ph		Ca		Si		ng		Is
	    \multirow{5}{*}{\centering\rot{\footnotesize{Kategorie}}}
		&	\footnotesize{Testrunner}	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& 		& 		&		& \ok	&		&  		&\\
	    &	\footnotesize{Testframework}
							    		&		& \ok	& \ok	& \ok	& \ok	& \ok	&		&		&		& \ok	&		& 		&\\
	    &	\footnotesize{End-To-End}	
									    & 		&		&		&		& \ok	&		&		& \ok	& \ok	& \ok	&		&  		&\\
	    &	\footnotesize{Assertion}	& 		&		& \ok	& \ok	& \ok	& \ok	& \ok	& 		& 		& \ok	& 		&  		&\\
	    &	\footnotesize{Sonstige}		&		&		&		&		&		&		&		&		&		&		& \ok	& \ok	& \ok \\\hline\hline
	    
	    \footnotesize{3}
	     &	\footnotesize{AngularJS-Support}	
									    & \ok	& \ok	& \nok\footnote{\url{https://github.com/angular/angular.js/issues/13971}}
																& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok
																													    & \ok	& \ok	& \ok \\
		\footnotesize{4}
		 & \footnotesize{Testausführung}& \ok	& 		& 	  	& 		& 		& \ok	& 		&		&		& \nok	&		&		& \\
		\footnotesize{5}
		 &	\footnotesize{Windows 7}			& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok 	& \ok \\
		\footnotesize{6}
		 & \footnotesize{benötigte Software}	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok 	& \ok\footnote{Zur Ausführung wird zwar Selenium benötigt, dies wird aber automatisiert mitinstalliert und ist daher ok.}
																										& \ok	& \nok	& \ok	& \ok 	& \ok \\
		\footnotesize{7}
		 & \footnotesize{Node.js 9.6.2}& \ok	& \ok	& \ok 	& \ok	& \ok	& \ok	& \ok	& \ok	&  \ok	& \ok	& \ok	& \ok	& \ok \\
		
		\footnotesize{8}
		 & \footnotesize{npm}			& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \nok	& \ok	& \ok	& \ok	& \ok \\
		\footnotesize{9}
		 & \footnotesize{Open Source \& kommerziell}
										& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok \\
		\footnotesize{10}
		 & \footnotesize{Wartung\footnote{Zur Auswertung dieser Anforderung wird das jeweilige Github-Repository herangezogen.}}
										& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \nok\footnote{1.841 offene Issues; 2 Issues geschlossen in der letzten Woche\cite{phantomjs-issues,phantomjs-pulse}}
																												& \ok	& \ok	& \ok	& \ok \\ 
		%11 & \textbf{ECMA-262 5.1}		& 		& \ok	&		&		&		&		& \ok	&		&		&		&		& \\
		\footnotesize{11}
		 & \footnotesize{Forcierte Beschreibung}
										&		& \ok	& \nok	& \ok	& \ok	& \ok	& 		& 		&		& \ok	& 		&		& \\
		\footnotesize{12}
			 & \footnotesize{BDD-Stil}	&		& \ok	& \nok	& \nok	& \ok	& \ok	& \ok	&		&		& \nok	&		& 		&\\
		\footnotesize{13} 
		& \footnotesize{Einarbeitung \& Verwendung}
										& \ok	& \ok	& \ok	& \ok	& \nok\footnote{Warten auf asynchrone AngularJS-Komponenten muss bei End-To-End-Tests manuell implementiert werden.}
																				& \ok	& \ok	& \ok	& \ok	& \nok\footnote{Warten auf asynchrone AngularJS-Komponenten muss manuell implementiert werden.}
																														& \ok	& \ok	& \ok \\
		\footnotesize{14}
		 & \footnotesize{Flexibilität}& 		& \ok	& \nok	& \nok	& \ok	& \nok	& 		&		&		& \nok	&		& 		& \\
		\footnotesize{15}
		 & \footnotesize{Code-Coverage}		
										& 		& 		& 		& 		& \ok	&		&		&		&		&		&		& 		& \ok\\ 
		\footnotesize{16}
		 & \footnotesize{Ausgabe-Konfiguration}
										& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	&		&		& 		& \nok	&		& 		& \ok \\
		\footnotesize{17}
		 & \footnotesize{Screenshots}	&		&		&		&		& \nok	&		&		& \ok	& \ok	& \ok	&		& 		&\\
		\footnotesize{18}
		 & \footnotesize{Spies, Stubs, Mocks}
										&		&		&		&		&		&		&		&		&		& 		& \ok	& \ok	& \\
		\footnotesize{19}
		 & \footnotesize{keine proprietären Dateien}
										& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok	& \ok						
	\end{tabularx}
	\captionof{table}{Entscheidungsmatrix zur Softwareauswahl\label{tbl:entscheidungsmatrix}}
	
	Die Auswertung der Entscheidungsmatrix zeigt, dass AVA, QUnit, Intern, Jasmine, PhantomJS sowie CasperJS nicht eingesetzt werden können, da sie Anforderungen widersprechen. Die Verbleibenden bilden die Basis für die zu treffende Auswahl aufgrund der Anforderungen. Es zeigt sich, dass nur durch den Einsatz aller verbleibender Software sämtliche Anforderungen abgedeckt werden können. Es wird somit folgende Auswahl getroffen:
	
	Als Test-Runner wird Karma eingesetzt, welches die benötigten JavaScript-Dateien importiert, bereitstellt und aus der Konsole heraus die in Mocha implementierten Tests ausführt. Die sich aus der Matrix ergebende Kombination von Mocha mit der Assertionbibliothek Chai wird von \textcite{mocha-index} bereits in der Softwaredokumentation aufgeführt, wodurch hier von einem problemlosen Zusammenarbeiten auszugehen ist. Für die Ermittlung der Code-Coverage wird Istanbul eingesetzt; die Kombination des Einsatzes mit Mocha wird in \cite{istanbul} explizit empfohlen, so dass auch hier von keinerlei Problemen auszugehen ist.
	
	Für die Realisierung von End-To-End-Tests wird auf das vom AngularJS-Team entwickelte Protractor zurückgegriffen und somit auch der Empfehlung aus der offiziellen AngularJS-Dokumentation \cite{angular-e2e} gefolgt. Die abweichende Kombination von Protractor mit Mocha und Chai, statt Jasmine, wird von vielen Entwicklern genutzt und unter Anderem in \cite{protractormocha-1} und \cite{protractormocha-2} beschrieben, so dass auch hier von keinen Problemen auszugehen ist.
	
	Für die Realisierung von Spies, Stubs und Mocks in Komponententests wird auf Sinon und ngMock gesetzt.
%\end{table}